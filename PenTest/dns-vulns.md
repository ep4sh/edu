# DNS коротко о главном без ~~еблимозга~~:

  * master (основное хранилище файлов зоны)  
  * slave (копирует с мастера)  
  * кэширующий (кэширует данны от предыдущих запросов, не знает корректны ли данные)  

   + авторитетный - официальный представитель зоны: master/slave - всегда авторитетны
   + неавторитетный - отвечает на запросы, пользуясь кэшом, обычно не пользуется зонами

   - нерекурсивный - вернет ссылку на авторитетный сервер
   - рекурсивынй - вернет ответ


Dns зона содержит записи обо всех компьютерах или поддоменах.

**_Авторитетный ответ_** - от сервера, обслуживающего данную зону (прямиком с диска)  
**_Неавторитетный_** - от другого сервера/кэша.

1. редактируем .options
2. Создаем файлы зон
3. редактируем named.conf.local




### DNS Amplification - атака с помощью неверно сконфигурированного DNS сервера.

Злоумышленник использует публичный DNS, который отвечает на рекурсивные запросы (сразу выдаёт ответ).
Подделав IPsrc на IP жертвы, шлет пакет на такой DNS сервер, DNS сервер отвечает пакетами с большой payload, трафик возрастает в x10-x100 раз.


Чтобы ограничить это, мы создадим acl, явно указав доверенные сети, кто может использовать DNS резолвинг.


_named.conf.option:_

```
acl good {
10.50.0.1/24;
localhost;
};
options {
.....
recursion yes;
allow-query { good;
};
```


### DNS spoofing

```vim /etc/ettercap/etter.dns```

Добавляем нужную запись для нашего фейка

```A 10.50.0.133 ```

```ettercap -G```

0. Sniff - unified sniffing, выбираем интерфейс  
1. ctrl+H, ctrl+S - открываем список хост, сканируем 2жды  
2. добавляем нужны хосты в TARGET 1
3. идём MITM - ARP poisoning - sniff remote connections
4. активируем dns_spoof плагин

